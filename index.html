<!DOCTYPE HTML>
<html ng-app="miniWeeblyApp">
   <head>
      <title>Mini-Weebly</title>
      <link rel="stylesheet" href="css/main.css" />

      <script src="js/angular.js"></script>
      <script src="js/app.js"></script>
   </head>
   <body>

      <div id="header">
         <div class="header-image">
         </div>
      </div>
      <div id="sideview">

         <h1>Templates</h1>
         <ul class="page-nav" ng-controller="pageCtrl">
            <li ng-repeat="page in pageService.pages" 
                ng-mouseenter="hover=true" 
                ng-mouseleave="hover=false"
                ng-class="{selected: pageService.currentIndex == $index, deleting: deleting}">

               <span ng-bind="page.title" ng-hide="editing"></span>
               <input class="transparent" 
                  ng-minlength="1"
                  ng-model="page.title" 
                  ng-show="editing"/>

               <div class="delete" 
                  ng-show="hover" 
                  ng-mouseenter="deleting=true"
                  ng-mouseleave="deleting=false"
                  ng-click="deletePage($index)">
               </div>
               <div class="edit" ng-show="hover" ng-click="editing = !editing"></div>
            </li>

            <li class="new transparent"> 
               <input class="transparent" 
                  type="text" 
                  placeholder="ADD NEW PAGE" 
                  ng-init="title=''" 
                  ng-model="title"/>

               <div class="add" ng-click="addPage()"></div>
            </li>
         </ul>

         <h1>Elements</h1>
         <ul class="element-nav" ng-controller="pageCtrl" ng-init="draggable=['title', 'text', 'image', 'nav']">
            <li ng-repeat="type in draggable" 
               ng-class="{ hovered: hover }">
               <div draggable 
                  ng-mouseenter="hover=true" 
                  ng-mouseleave="hover=false" 
                  class="{{ type }}" 
                  type="{{ type }}">
               </div>
               <h4 ng-bind="type"></h4>
            </li>
         </ul>
         <h1>Settings</h1>
         <div 
            class="settings-nav" 
            ng-class="{ enabled: enabled }"
            ng-init="enabled=false">
            <span>Site Grid</span>
            <div ng-click="enabled=!enabled" class="settings-image">
            </div>
         </div>

      </div>

      <div id="templateview" ng-controller="pageCtrl"> 
         <ul class="template-nav">
            <li ng-repeat="page in pageService.pages" 
                  ng-click="selectPage($index)" 
                  ng-class="{selected: page == pageService.currentPage }">

               <span ng-bind=page.title></span>
            </li>
         </ul>

         <div droppable
            ng-controller="templateCtrl" class="group-drop">

            <h1 ng-show="pageService.currentPage.groups.length == 0">
               Add content here
            </h1>

            <ul class="groups-view">

               <li ng-repeat="group in pageService.currentPage.groups"
                  ng-class="{ 
                  'drop-indicator': isInThisGroup($index), 
                  'drop-indicator-bottom': isInThisGroup($index+1) && isLastGroup() }"> 

                  <div 
                     ng-show="isInThisElement($index, 0)" 
                     class="element-container half">
                     <div class="element drop-indicator left">
                     </div>
                  </div>

                  <div ng-repeat="element in group.elements"
                     class="element-container"
                     ng-class="{ half: group.elements.length > 1
                        || (hoverGroupIndex == $parent.$index && hoverElementIndex > -1) 
                     }">

                     <div class='element {{ element.type }}'
                        resizable
                        ng-mouseenter="hover = true"
                        ng-mouseleave="hover = (false || dragging)"
                        ng-class="{ hovered: hover && !servDrop.active, deleting: deleting && !servDrop.active }"
                        ng-style="{ height: element.size.height + 'px' }">
                     

                        <div class="delete"
                           ng-mouseenter="deleting = true"
                           ng-mouseleave="deleting = false"
                           ng-show="hover && !servDrop.active" 
                           ng-click="deleteElement($parent.$index, $index)">
                        </div>

                        <div 
                           ng-show="element.type == 'image'">
                           <div class="image-background">
                              Add Image +
                           </div>
                        </div>

                        <div class="nav"
                           ng-show="element.type == 'nav'">
                           <span>
                              Webpage Navigation
                           </span>
                        </div>

                        <input 
                           placeholder="Add Title Here"
                           ng-model="element.content"
                           ng-show="element.type == 'title'"/>

                        <textarea
                           placeholder="Start typing here."
                           ng-model="element.content"
                           ng-show="element.type == 'text'">
                        </textarea>

                     </div>

                  </div>

                  <div 
                     ng-show="isInThisElement($index, 1)" 
                     class="element-container half">
                     <div class="element drop-indicator right">
                     </div>
                  </div>

                  <div style="clear: both;"></div>
               </li>
            </ul>
         </div>
      </div>

   </body>
</html>
